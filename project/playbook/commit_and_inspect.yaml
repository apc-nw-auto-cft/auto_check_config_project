---
- name: "test show"
  hosts: junos
  gather_facts: false

  tasks:
    - name: "block to share condition"
      vars:
        target_hosts:
          - "vmx01"
          - "vmx02"
        path_to_material: "{{ playbook_dir }}/../material"
      when: inventory_hostname in target_hosts
      block:
        - name: "include_vars operation"
          ansible.builtin.include_vars:
            file: "{{ path_to_material }}/operation.yaml"
          delegate_to: localhost

        - name: "include_vars expect"
          ansible.builtin.include_vars:
            file: "{{ path_to_material }}/{{ operation }}/expect.yaml"
            name: expect
          delegate_to: localhost

        - name: "import inspect"
          ansible.builtin.import_role:
            name: inspect
          vars:
            before_or_after: before

        - name: "import commit_config"
          ansible.builtin.import_role:
            name: commit_config

        - name: "import inspect"
          ansible.builtin.import_role:
            name: inspect
          vars:
            before_or_after: after
